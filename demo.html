<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ful-ExcelExport Demo</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 40px 20px;
      }

      .container {
        max-width: 900px;
        margin: 0 auto;
      }

      .header {
        text-align: center;
        color: white;
        margin-bottom: 40px;
      }

      .header h1 {
        font-size: 3rem;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
      }

      .header p {
        font-size: 1.2rem;
        opacity: 0.9;
      }

      .header .open-source-badge {
        display: inline-block;
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        padding: 4px 16px;
        border-radius: 20px;
        font-weight: 700;
        font-size: 0.9rem;
        margin-left: 10px;
        vertical-align: middle;
      }

      .feature-badges {
        display: flex;
        justify-content: center;
        gap: 12px;
        margin-top: 20px;
        flex-wrap: wrap;
      }

      .feature-badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 8px 16px;
        border-radius: 30px;
        font-size: 0.9rem;
        font-weight: 600;
        backdrop-filter: blur(10px);
      }

      .feature-badge.frontend {
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
      }

      .feature-badge.data {
        background: linear-gradient(135deg, #3b82f6, #2563eb);
        color: white;
        box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
      }

      .feature-badge.memory {
        background: linear-gradient(135deg, #f59e0b, #d97706);
        color: white;
        box-shadow: 0 4px 15px rgba(245, 158, 11, 0.4);
      }

      .feature-badge .icon {
        font-size: 1.1rem;
      }

      .card {
        background: white;
        border-radius: 16px;
        padding: 30px;
        margin-bottom: 20px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
      }

      .card h2 {
        color: #333;
        margin-bottom: 20px;
        font-size: 1.5rem;
      }

      .form-group {
        margin-bottom: 20px;
      }

      .form-group label {
        display: block;
        margin-bottom: 8px;
        color: #666;
        font-weight: 500;
      }

      .form-group input,
      .form-group select {
        width: 100%;
        padding: 12px 16px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        font-size: 1rem;
        transition: border-color 0.3s;
      }

      .form-group input:focus,
      .form-group select:focus {
        outline: none;
        border-color: #667eea;
      }

      .row {
        display: flex;
        gap: 20px;
      }

      .row .form-group {
        flex: 1;
      }

      .btn {
        display: inline-block;
        padding: 14px 28px;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
      }

      .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
      }

      .btn-primary:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
      }

      .progress-container {
        margin-top: 30px;
        display: none;
      }

      .progress-container.active {
        display: block;
      }

      .progress-bar {
        height: 20px;
        background: #e0e0e0;
        border-radius: 10px;
        overflow: hidden;
        margin-bottom: 15px;
      }

      .progress-bar-fill {
        height: 100%;
        background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
        width: 0%;
        transition: width 0.3s;
        border-radius: 10px;
      }

      .progress-info {
        display: flex;
        justify-content: space-between;
        color: #666;
        font-size: 0.9rem;
      }

      .progress-stage {
        font-weight: 600;
        color: #667eea;
      }

      .progress-message {
        text-align: center;
        margin-top: 10px;
        color: #888;
      }

      .progress-time {
        margin-top: 8px;
        color: #606266;
        font-size: 12px;
        text-align: center;
      }

      .progress-memory {
        margin-top: 15px;
        padding-top: 12px;
        border-top: 1px solid #eee;
      }

      .memory-bar {
        height: 8px;
        background: #e4e7ed;
        border-radius: 4px;
        overflow: hidden;
        margin-bottom: 8px;
      }

      .memory-used {
        height: 100%;
        background: linear-gradient(
          90deg,
          #67c23a 0%,
          #e6a23c 70%,
          #f56c6c 100%
        );
        border-radius: 4px;
        transition: width 0.3s ease;
      }

      .memory-text {
        font-size: 12px;
        color: #606266;
        text-align: center;
      }

      .memory-limit {
        color: #909399;
      }

      .features {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-top: 20px;
      }

      .feature-item {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px;
        background: #f8f9fa;
        border-radius: 8px;
      }

      .feature-item.pro-feature {
        background: linear-gradient(135deg, #f5f3ff 0%, #ede9fe 100%);
        border: 1px solid #c4b5fd;
        cursor: pointer;
        position: relative;
      }

      .feature-item.pro-feature:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
      }

      .feature-item.pro-feature::after {
        content: "ğŸ’";
        position: absolute;
        top: -6px;
        right: -6px;
        font-size: 12px;
      }

      .feature-item.pro-feature small {
        color: #7c3aed;
        font-weight: 700;
        background: linear-gradient(135deg, #667eea, #764ba2);
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .checkbox-item.pro-disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .checkbox-item.pro-disabled:hover {
        opacity: 0.7;
      }

      .pro-tag {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white !important;
        padding: 1px 6px;
        border-radius: 4px;
        font-size: 10px;
        font-weight: 600;
        margin-left: 4px;
      }

      /* Pro æ‚¬æµ®æç¤º */
      .pro-tooltip {
        position: fixed;
        background: linear-gradient(135deg, #1e1b4b, #312e81);
        color: white;
        padding: 12px 16px;
        border-radius: 8px;
        font-size: 13px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        z-index: 1000;
        pointer-events: none;
        opacity: 0;
        transition: opacity 0.2s;
      }

      .pro-tooltip.visible {
        opacity: 1;
      }

      .pro-tooltip .price {
        font-size: 18px;
        font-weight: 700;
        color: #fbbf24;
        display: block;
        margin-top: 4px;
      }

      .feature-item .icon {
        font-size: 1.5rem;
      }

      .feature-item span {
        color: #333;
        font-size: 0.9rem;
      }

      .checkbox-group {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
      }

      .checkbox-item {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 12px;
        background: #f8f9fa;
        border-radius: 8px;
      }

      .checkbox-item.pro-disabled {
        background: linear-gradient(135deg, #f3f4f6, #e5e7eb);
        border: 1px solid #d1d5db;
        opacity: 0.7;
        cursor: not-allowed;
      }

      .checkbox-item input[type="checkbox"] {
        width: 18px;
        height: 18px;
        accent-color: #667eea;
      }

      .debug-log {
        background: #1e1b4b;
        color: #a5b4fc;
        border-radius: 8px;
        padding: 15px;
        font-family: "Monaco", "Consolas", monospace;
        font-size: 12px;
        max-height: 200px;
        overflow-y: auto;
        margin-top: 20px;
      }

      .debug-log .log-entry {
        margin-bottom: 4px;
        padding: 2px 0;
        border-bottom: 1px solid #312e81;
      }

      .debug-log .log-entry.success {
        color: #34d399;
      }

      .debug-log .log-entry.error {
        color: #f87171;
      }

      .debug-log .log-entry.info {
        color: #60a5fa;
      }

      .btn-secondary {
        background: linear-gradient(135deg, #6b7280, #4b5563);
        color: white;
        border: none;
        padding: 15px 30px;
        font-size: 1.1rem;
        font-weight: 600;
        border-radius: 12px;
        cursor: pointer;
        margin-left: 10px;
      }

      .btn-secondary:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 20px rgba(107, 114, 128, 0.4);
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="lang-switch" style="text-align: right; margin-bottom: 10px">
        <a
          href="demo.en.html"
          style="
            color: white;
            text-decoration: none;
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            font-size: 14px;
          "
          >English</a
        >
      </div>

      <div class="header">
        <h1>
          ğŸ“Š Ful-ExcelExport <span class="open-source-badge">å¼€æºç‰ˆ</span>
        </h1>
        <p>100% çº¯å‰ç«¯ Excel å¯¼å‡º Â· æ— éœ€åç«¯æœåŠ¡å™¨</p>
        <div class="feature-badges">
          <span class="feature-badge frontend">
            <span class="icon">ğŸŒ</span> çº¯å‰ç«¯è¿è¡Œ
          </span>
          <span class="feature-badge data">
            <span class="icon">ğŸ“Š</span> åƒä¸‡çº§æ•°æ®
          </span>
          <span class="feature-badge memory">
            <span class="icon">ğŸ’¾</span> å†…å­˜ç¨³å®š ä»…å ç”¨50MB
          </span>
        </div>
      </div>

      <!-- æŠ€æœ¯äº®ç‚¹å¡ç‰‡ -->
      <div
        class="card"
        style="
          background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
          border: 2px solid #22c55e;
        "
      >
        <h2 style="color: #15803d">
          ğŸ† å¸‚åœºå”¯ä¸€ï¼šçº¯å‰ç«¯ + é«˜æ€§èƒ½ + åƒä¸‡çº§ + å…¨æ ·å¼
        </h2>
        <p style="color: #666; margin-bottom: 20px; font-size: 0.95rem">
          æˆ‘ä»¬æ˜¯å¸‚åœºä¸Š<strong style="color: #15803d">å”¯ä¸€</strong
          >åŒæ—¶æ»¡è¶³ã€Œçº¯å‰ç«¯ã€ã€Œé«˜æ€§èƒ½ã€ã€Œåƒä¸‡çº§æ•°æ®ã€ã€Œå†…å­˜ç¨³å®šã€ã€Œå…¨æ ·å¼æ”¯æŒã€äº”ä¸ªæ¡ä»¶çš„åº“ã€‚
        </p>
        <div
          style="
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
          "
        >
          <div
            style="
              padding: 15px;
              background: white;
              border-radius: 12px;
              box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            "
          >
            <div style="font-size: 1.5rem; margin-bottom: 8px">ğŸŒ</div>
            <div style="font-weight: 700; color: #15803d; margin-bottom: 5px">
              100% çº¯å‰ç«¯
            </div>
            <div style="color: #666; font-size: 0.9rem">
              æ‰€æœ‰å¤„ç†å‡åœ¨æµè§ˆå™¨å®Œæˆï¼Œåç«¯æœåŠ¡å™¨é›¶è´Ÿæ‹…
            </div>
          </div>
          <div
            style="
              padding: 15px;
              background: white;
              border-radius: 12px;
              box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            "
          >
            <div style="font-size: 1.5rem; margin-bottom: 8px">ğŸ“Š</div>
            <div style="font-weight: 700; color: #15803d; margin-bottom: 5px">
              åƒä¸‡çº§æ•°æ®
            </div>
            <div style="color: #666; font-size: 0.9rem">
              SheetJS/ExcelJS ç™¾ä¸‡è¡Œå´©æºƒï¼Œæœ¬åº“åƒä¸‡è¡Œä»…å  50-100MB å†…å­˜ã€‚
            </div>
          </div>
          <div
            style="
              padding: 15px;
              background: white;
              border-radius: 12px;
              box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            "
          >
            <div style="font-size: 1.5rem; margin-bottom: 8px">ğŸ¨</div>
            <div style="font-weight: 700; color: #15803d; margin-bottom: 5px">
              é«˜åº¦æ ·å¼è¿˜åŸ
            </div>
            <div style="color: #666; font-size: 0.9rem">
              å®Œæ•´æ”¯æŒèƒŒæ™¯è‰²ã€å­—ä½“ã€è¾¹æ¡†ã€å¯¹é½ã€å¯Œæ–‡æœ¬ç­‰ï¼Œå¯¼å‡ºä¸é¡µé¢ä¸€è‡´ã€‚
            </div>
          </div>
        </div>
        <!-- å¯¹æ¯”è¡¨æ ¼ -->
        <div style="margin-top: 20px; overflow-x: auto">
          <table
            style="
              width: 100%;
              border-collapse: collapse;
              font-size: 0.9rem;
              background: white;
              border-radius: 8px;
              overflow: hidden;
            "
          >
            <thead>
              <tr style="background: #15803d; color: white">
                <th style="padding: 12px; text-align: left">åº“</th>
                <th style="padding: 12px; text-align: center">çº¯å‰ç«¯</th>
                <th style="padding: 12px; text-align: center">é«˜æ€§èƒ½å¯¼å‡º</th>
                <th style="padding: 12px; text-align: center">åƒä¸‡çº§</th>
                <th style="padding: 12px; text-align: center">å†…å­˜ç¨³å®š</th>
                <th style="padding: 12px; text-align: center">å®Œæ•´æ ·å¼</th>
              </tr>
            </thead>
            <tbody>
              <tr style="border-bottom: 1px solid #e5e7eb">
                <td style="padding: 10px">SheetJS</td>
                <td style="padding: 10px; text-align: center">âœ…</td>
                <td style="padding: 10px; text-align: center">âŒ</td>
                <td style="padding: 10px; text-align: center">âŒ</td>
                <td style="padding: 10px; text-align: center">âŒ</td>
                <td style="padding: 10px; text-align: center">ğŸ’°ä»˜è´¹</td>
              </tr>
              <tr style="border-bottom: 1px solid #e5e7eb">
                <td style="padding: 10px">ExcelJS</td>
                <td style="padding: 10px; text-align: center">âš ï¸</td>
                <td style="padding: 10px; text-align: center">âš ï¸</td>
                <td style="padding: 10px; text-align: center">âŒ</td>
                <td style="padding: 10px; text-align: center">âŒ</td>
                <td style="padding: 10px; text-align: center">âœ…</td>
              </tr>
              <tr style="border-bottom: 1px solid #e5e7eb">
                <td style="padding: 10px">xlsx-stream</td>
                <td style="padding: 10px; text-align: center">âŒ</td>
                <td style="padding: 10px; text-align: center">âœ…</td>
                <td style="padding: 10px; text-align: center">âœ…</td>
                <td style="padding: 10px; text-align: center">âœ…</td>
                <td style="padding: 10px; text-align: center">âŒ</td>
              </tr>
              <tr style="background: #dcfce7; font-weight: 700">
                <td style="padding: 10px; color: #15803d">Ful-ExcelExport</td>
                <td style="padding: 10px; text-align: center">âœ…</td>
                <td style="padding: 10px; text-align: center">âœ…</td>
                <td style="padding: 10px; text-align: center">âœ…</td>
                <td style="padding: 10px; text-align: center">âœ…</td>
                <td style="padding: 10px; text-align: center">âœ…</td>
              </tr>
            </tbody>
          </table>
        </div>
        <!-- ç‰¹ç‚¹è¯´æ˜ -->
        <div
          style="
            margin-top: 20px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #15803d;
          "
        >
          <div style="font-weight: 700; color: #15803d; margin-bottom: 8px">
            âœ¨ å¼€ç®±å³ç”¨
          </div>
          <div style="font-size: 0.9rem; color: #666">
            <strong>é›¶ä¾èµ–å®‰è£…</strong> - åªéœ€
            <code
              style="background: #f3f4f6; padding: 2px 6px; border-radius: 4px"
              >npm install Ful-ExcelExport</code
            >ï¼Œæ— éœ€å®‰è£…ä»»ä½•å…¶ä»–åŒ…ã€‚ æ‰€æœ‰åŠŸèƒ½å·²å†…ç½®ï¼Œç›´æ¥ä½¿ç”¨å³å¯ã€‚
          </div>
        </div>
      </div>

      <div class="card">
        <h2>ğŸ“ å¯¼å‡ºé…ç½®</h2>

        <div class="row">
          <div class="form-group">
            <label>æ•°æ®è¡Œæ•°</label>
            <select id="rowCount">
              <option value="100">100 è¡Œï¼ˆæµ‹è¯•ï¼‰</option>
              <option value="1000">1,000 è¡Œ</option>
              <option value="10000">10,000 è¡Œ</option>
              <option value="100000" selected>100,000 è¡Œï¼ˆåä¸‡ï¼‰</option>
              <option value="1000000">1,000,000 è¡Œï¼ˆç™¾ä¸‡çº§ï¼‰</option>
              <option value="5000000">5,000,000 è¡Œï¼ˆäº”ç™¾ä¸‡ï¼‰</option>
              <option value="10000000">10,000,000 è¡Œï¼ˆåƒä¸‡çº§ï¼‰</option>
            </select>
          </div>
          <div class="form-group">
            <label>åˆ—æ•°</label>
            <select id="colCount">
              <option value="5">5 åˆ—</option>
              <option value="10" selected>10 åˆ—</option>
              <option value="20">20 åˆ—</option>
              <option value="50">50 åˆ—</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label>æ–‡ä»¶å</label>
          <input type="text" id="fileName" value="demo-export.xlsx" />
        </div>

        <div class="form-group">
          <label
            >åŠŸèƒ½å¼€å…³
            <small style="color: #666"
              >ï¼ˆå‹¾é€‰ååœ¨æ•°æ®å¼€å¤´æ’å…¥æ¼”ç¤ºè¡Œï¼‰</small
            ></label
          >
          <div class="checkbox-group">
            <label
              class="checkbox-item"
              title="èƒŒæ™¯è‰²ã€å­—ä½“é¢œè‰²ã€ç²—ä½“ã€æ–œä½“ã€è¾¹æ¡†ã€å¯¹é½ã€å­—å·"
            >
              <input type="checkbox" id="includeStyles" checked />
              <span
                >ğŸ¨ å•å…ƒæ ¼æ ·å¼
                <small style="color: #888"
                  >èƒŒæ™¯/é¢œè‰²/ç²—ä½“/æ–œä½“/è¾¹æ¡†/å¯¹é½</small
                ></span
              >
            </label>
            <label
              class="checkbox-item"
              title="æ”¯æŒ <b> <i> <u> <s> <br> æ ‡ç­¾åŠ style å±æ€§"
            >
              <input type="checkbox" id="includeRichText" checked />
              <span
                >ğŸ“ å¯Œæ–‡æœ¬
                <small style="color: #888">HTMLæ ‡ç­¾ + style</small></span
              >
            </label>
            <label
              class="checkbox-item pro-disabled pro-feature"
              data-pro="hyperlink"
              title="ğŸ’ Pro åŠŸèƒ½ - è”ç³»è·å–æŠ¥ä»·"
            >
              <input type="checkbox" disabled />
              <span
                >ğŸ”— è¶…é“¾æ¥ <small class="pro-tag">Pro</small>
                <small style="color: #888">mailto/http</small></span
              >
            </label>
            <label
              class="checkbox-item pro-disabled pro-feature"
              data-pro="merge"
              title="ğŸ’ Pro åŠŸèƒ½ - è”ç³»è·å–æŠ¥ä»·"
            >
              <input type="checkbox" disabled />
              <span
                >ğŸ“Š åˆå¹¶å•å…ƒæ ¼ <small class="pro-tag">Pro</small>
                <small style="color: #888">rowSpan/colSpan</small></span
              >
            </label>
            <label
              class="checkbox-item pro-disabled pro-feature"
              data-pro="rowcol"
              title="ğŸ’ Pro åŠŸèƒ½ - è”ç³»è·å–æŠ¥ä»·"
            >
              <input type="checkbox" disabled />
              <span
                >ğŸ“ è¡Œé«˜åˆ—å®½ <small class="pro-tag">Pro</small>
                <small style="color: #888">height/width</small></span
              >
            </label>
            <label
              class="checkbox-item pro-disabled pro-feature"
              data-pro="image"
              title="ğŸ’ Pro åŠŸèƒ½ - è”ç³»è·å–æŠ¥ä»·"
            >
              <input type="checkbox" disabled />
              <span
                >ğŸ–¼ï¸ å›¾ç‰‡åµŒå…¥ <small class="pro-tag">Pro</small>
                <small style="color: #888">base64</small></span
              >
            </label>
          </div>
          <div
            style="
              margin-top: 8px;
              padding: 8px 12px;
              background: #fef3c7;
              border-radius: 6px;
              font-size: 12px;
              color: #92400e;
            "
          >
            ğŸ’¡
            å‹¾é€‰åŠŸèƒ½åï¼Œä¼šåœ¨<strong>æ•°æ®å¼€å¤´</strong>æ’å…¥æ¼”ç¤ºè¡Œï¼ˆæ¯é¡¹3è¡Œï¼‰ï¼Œè¦†ç›–å„ç§æ•ˆæœ
          </div>
        </div>

        <!-- Pro æ‚¬æµ®æç¤º -->
        <div class="pro-tooltip" id="proTooltip">
          <div id="proTooltipText">è§£é”é«˜çº§åŠŸèƒ½</div>
          <span class="price">Â¥4999 / æ°¸ä¹…æˆæƒ</span>
        </div>

        <button class="btn btn-primary" id="exportBtn" onclick="startExport()">
          ğŸš€ å¼€å§‹å¯¼å‡º
        </button>
        <button class="btn btn-secondary" onclick="clearLog()">
          ğŸ—‘ï¸ æ¸…ç©ºæ—¥å¿—
        </button>

        <div class="progress-container" id="progressContainer">
          <div class="progress-bar">
            <div class="progress-bar-fill" id="progressFill"></div>
          </div>
          <div class="progress-info">
            <span class="progress-stage" id="progressStage">å‡†å¤‡ä¸­...</span>
            <span id="progressPercent">0%</span>
          </div>
          <div class="progress-message" id="progressMessage">æ­£åœ¨åˆå§‹åŒ–...</div>
          <div class="progress-time" id="progressTime" style="display: none">
            å·²ç”¨æ—¶: 0s
          </div>
          <div
            class="progress-memory"
            id="progressMemory"
            style="display: none"
          >
            <div class="memory-bar">
              <div class="memory-used" id="memoryUsed" style="width: 0%"></div>
            </div>
            <div class="memory-text">
              å†…å­˜: <span id="memUsedHeap">0</span>MB /
              <span id="memTotalHeap">0</span>MB
              <span class="memory-limit"
                >(é™åˆ¶: <span id="memLimit">0</span>MB)</span
              >
            </div>
          </div>
        </div>

        <div class="debug-log" id="debugLog">
          <div class="log-entry info">[ç³»ç»Ÿ] Demo è°ƒè¯•ç¯å¢ƒå·²åŠ è½½</div>
        </div>
      </div>

      <!-- å•†ä¸šåˆä½œå¡ç‰‡ -->
      <div
        class="card"
        style="
          background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
          border: 2px solid #f59e0b;
        "
      >
        <h2 style="color: #b45309">ğŸ’¼ å•†ä¸šåˆä½œ & æŠ€æœ¯å’¨è¯¢</h2>
        <div
          style="
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 15px;
          "
        >
          <!-- Pro ä¸“ä¸šç‰ˆ -->
          <div
            style="
              padding: 20px;
              background: white;
              border-radius: 12px;
              box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
              text-align: center;
            "
          >
            <div style="font-size: 2rem; margin-bottom: 10px">ğŸš€</div>
            <div
              style="
                font-weight: 700;
                color: #b45309;
                font-size: 1.2rem;
                margin-bottom: 10px;
              "
            >
              Pro ä¸“ä¸šç‰ˆ
            </div>
            <ul
              style="
                text-align: left;
                color: #666;
                font-size: 0.9rem;
                padding-left: 20px;
                margin-bottom: 15px;
              "
            >
              <li>âœ… è‡ªå®šä¹‰è¡Œé«˜åˆ—å®½</li>
              <li>âœ… å›¾ç‰‡åµŒå…¥</li>
              <li>âœ… è¶…é“¾æ¥</li>
              <li>âœ… æŠ€æœ¯æ”¯æŒ</li>
            </ul>
            <div style="color: #b45309; font-weight: 600">
              è”ç³»è·å–æŠ¥ä»·<br />ğŸ“§ 634688344@qq.com
            </div>
          </div>
          <!-- æŠ€æœ¯å’¨è¯¢ -->
          <div
            style="
              padding: 20px;
              background: white;
              border-radius: 12px;
              box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
              text-align: center;
            "
          >
            <div style="font-size: 2rem; margin-bottom: 10px">ğŸ’¬</div>
            <div
              style="
                font-weight: 700;
                color: #b45309;
                font-size: 1.2rem;
                margin-bottom: 10px;
              "
            >
              æŠ€æœ¯å’¨è¯¢
            </div>
            <ul
              style="
                text-align: left;
                color: #666;
                font-size: 0.9rem;
                padding-left: 20px;
                margin-bottom: 15px;
              "
            >
              <li>ğŸ“Š å¤§æ•°æ®å¯¼å‡ºæ–¹æ¡ˆè®¾è®¡</li>
              <li>ğŸ”§ å®šåˆ¶åŠŸèƒ½å¼€å‘</li>
              <li>ğŸ“š æŠ€æœ¯åŸ¹è®­</li>
            </ul>
            <div style="color: #b45309; font-weight: 600">æ‰«ç å’¨è¯¢ â†“</div>
            <div style="margin-top: 15px; text-align: center">
              <img
                src="./assets/user/wechat.jpg"
                width="150"
                style="border-radius: 8px"
              />
            </div>
          </div>
        </div>
      </div>

      <!-- æèµ å¡ç‰‡ -->
      <div
        class="card"
        style="
          background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);
          border: 2px solid #ec4899;
        "
      >
        <h2 style="color: #be185d">â˜• æ”¯æŒé¡¹ç›®</h2>
        <p style="color: #9d174d; margin-bottom: 20px">
          å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿æ”¯æŒä¸€ä¸‹ï¼ä½ çš„é¼“åŠ±æ˜¯æˆ‘æŒç»­æ”¹è¿›çš„åŠ¨åŠ› ğŸ’ª
        </p>
        <div
          style="
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
          "
        >
          <!-- Star -->
          <div
            style="
              padding: 20px;
              background: white;
              border-radius: 12px;
              text-align: center;
              box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            "
          >
            <div style="font-size: 2rem; margin-bottom: 10px">â­</div>
            <div style="font-weight: 700; color: #be185d; margin-bottom: 10px">
              ç»™ä¸ª Star
            </div>
            <div style="color: #666; font-size: 0.85rem; margin-bottom: 15px">
              æœ€ç®€å•çš„æ”¯æŒæ–¹å¼
            </div>
            <a
              href="https://github.com/Ful-Bee/Ful-ExcelExport"
              target="_blank"
              style="
                display: inline-block;
                padding: 8px 20px;
                background: #be185d;
                color: white;
                text-decoration: none;
                border-radius: 20px;
                font-size: 0.9rem;
              "
              >å‰å¾€ GitHub â­</a
            >
          </div>
          <!-- æ”¯ä»˜å® -->
          <div
            style="
              padding: 20px;
              background: white;
              border-radius: 12px;
              text-align: center;
              box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            "
          >
            <div style="font-size: 2rem; margin-bottom: 10px">ğŸ’°</div>
            <div style="font-weight: 700; color: #be185d; margin-bottom: 10px">
              è¯·æˆ‘å–æ¯å’–å•¡
            </div>
            <div style="margin-top: 10px; text-align: center">
              <img
                src="./assets/user/aliPay.jpg"
                width="150"
                style="border-radius: 8px"
              />
            </div>
          </div>
        </div>
        <p
          style="
            text-align: center;
            margin-top: 20px;
            color: #9d174d;
            font-size: 0.9rem;
          "
        >
          æ¯ä¸€ä¸ª Star å’Œèµèµéƒ½æ˜¯è«å¤§çš„é¼“åŠ±ï¼ğŸ™
        </p>
      </div>
    </div>

    <script type="module">
      // Demo - å…è´¹ç‰ˆåŠŸèƒ½æ¼”ç¤º
      import FulExcelExport from "./ful-excel-export.esm.js";

      // æ—¥å¿—å‡½æ•°
      function log(message, type = "info") {
        const debugLog = document.getElementById("debugLog");
        const entry = document.createElement("div");
        entry.className = `log-entry ${type}`;
        const time = new Date().toLocaleTimeString();
        entry.textContent = `[${time}] ${message}`;
        debugLog.appendChild(entry);
        debugLog.scrollTop = debugLog.scrollHeight;
        console.log(`[${type}] ${message}`);
      }

      window.clearLog = function () {
        document.getElementById("debugLog").innerHTML =
          '<div class="log-entry info">[ç³»ç»Ÿ] æ—¥å¿—å·²æ¸…ç©º</div>';
      };

      log("Demo è°ƒè¯•ç¯å¢ƒå·²å°±ç»ª", "success");

      // Pro åŠŸèƒ½æ‚¬æµ®æç¤º
      const proFeatures = {
        hyperlink:
          "ğŸ”— è¶…é“¾æ¥åŠŸèƒ½ï¼šä¸ºå•å…ƒæ ¼æ·»åŠ å¯ç‚¹å‡»é“¾æ¥ï¼Œæ”¯æŒç½‘é¡µã€é‚®ä»¶ã€å†…éƒ¨è·³è½¬",
        merge: "ğŸ“ å•å…ƒæ ¼åˆå¹¶ï¼šçµæ´»åˆå¹¶ä»»æ„åŒºåŸŸçš„å•å…ƒæ ¼ï¼Œåˆ¶ä½œä¸“ä¸šæŠ¥è¡¨",
        rowcol: "ğŸ“ è¡Œé«˜åˆ—å®½ï¼šç²¾ç¡®æ§åˆ¶è¡Œé«˜å’Œåˆ—å®½ï¼Œå®Œç¾å‘ˆç°æ•°æ®",
        image: "ğŸ–¼ï¸ å›¾ç‰‡åµŒå…¥ï¼šæ”¯æŒå°†å›¾ç‰‡åµŒå…¥åˆ° Excel å•å…ƒæ ¼ä¸­",
      };

      const tooltip = document.getElementById("proTooltip");
      const tooltipText = document.getElementById("proTooltipText");

      document.querySelectorAll(".pro-feature").forEach((el) => {
        el.addEventListener("mouseenter", (e) => {
          const feature = el.dataset.pro;
          tooltipText.textContent = proFeatures[feature] || "Pro ä¸“ä¸šç‰ˆåŠŸèƒ½";
          tooltip.classList.add("visible");
        });

        el.addEventListener("mousemove", (e) => {
          tooltip.style.left = e.clientX + 15 + "px";
          tooltip.style.top = e.clientY + 15 + "px";
        });

        el.addEventListener("mouseleave", () => {
          tooltip.classList.remove("visible");
        });

        el.addEventListener("click", () => {
          alert(
            "ğŸ’ Pro ä¸“ä¸šç‰ˆåŠŸèƒ½\n\nåŒ…å«ï¼šè¶…é“¾æ¥ã€å•å…ƒæ ¼åˆå¹¶ã€è¡Œé«˜åˆ—å®½ã€å›¾ç‰‡åµŒå…¥\n\nè”ç³»è·å–æŠ¥ä»·ï¼š634688344@qq.com"
          );
        });
      });

      window.startExport = async function () {
        const rowCount = parseInt(document.getElementById("rowCount").value);
        const colCount = parseInt(document.getElementById("colCount").value);
        const fileName =
          document.getElementById("fileName").value || "export.xlsx";
        const includeStyles = document.getElementById("includeStyles").checked;
        const includeRichText =
          document.getElementById("includeRichText").checked;

        const btn = document.getElementById("exportBtn");
        const progressContainer = document.getElementById("progressContainer");
        const progressFill = document.getElementById("progressFill");
        const progressStage = document.getElementById("progressStage");
        const progressPercent = document.getElementById("progressPercent");
        const progressMessage = document.getElementById("progressMessage");
        const progressTime = document.getElementById("progressTime");
        const progressMemory = document.getElementById("progressMemory");
        const memoryUsed = document.getElementById("memoryUsed");
        const memUsedHeap = document.getElementById("memUsedHeap");
        const memTotalHeap = document.getElementById("memTotalHeap");
        const memLimit = document.getElementById("memLimit");

        btn.disabled = true;
        btn.textContent = "â³ å¯¼å‡ºä¸­...";
        progressContainer.classList.add("active");
        progressTime.style.display = "block";
        progressMemory.style.display = "block";

        // è®¡æ—¶å™¨
        const startTime = Date.now();
        const timer = setInterval(() => {
          const elapsed = Math.floor((Date.now() - startTime) / 1000);
          const minutes = Math.floor(elapsed / 60);
          const seconds = elapsed % 60;
          progressTime.textContent =
            minutes > 0
              ? `å·²ç”¨æ—¶: ${minutes}m ${seconds}s`
              : `å·²ç”¨æ—¶: ${seconds}s`;
        }, 1000);

        // æ•°æ®æº
        const colNames = [
          "å§“å",
          "å¹´é¾„",
          "éƒ¨é—¨",
          "èŒä½",
          "å·¥å·",
          "å…¥èŒæ—¥æœŸ",
          "è–ªèµ„",
          "é‚®ç®±",
          "ç”µè¯",
          "åœ°å€",
          "å­¦å†",
          "ä¸“ä¸š",
          "ç±è´¯",
          "æ°‘æ—",
          "æ”¿æ²»é¢è²Œ",
          "å©šå§»çŠ¶å†µ",
          "ç´§æ€¥è”ç³»äºº",
          "ç´§æ€¥ç”µè¯",
          "å¤‡æ³¨1",
          "å¤‡æ³¨2",
        ];
        const departments = [
          "æŠ€æœ¯éƒ¨",
          "äº§å“éƒ¨",
          "è®¾è®¡éƒ¨",
          "å¸‚åœºéƒ¨",
          "è´¢åŠ¡éƒ¨",
          "äººäº‹éƒ¨",
        ];
        const names = [
          "å¼ ä¸‰",
          "æå››",
          "ç‹äº”",
          "èµµå…­",
          "é’±ä¸ƒ",
          "å­™å…«",
          "å‘¨ä¹",
          "å´å",
        ];
        const positions = ["å·¥ç¨‹å¸ˆ", "ç»ç†", "æ€»ç›‘", "ä¸“å‘˜", "ä¸»ç®¡", "åŠ©ç†"];

        log(`å¼€å§‹å¯¼å‡º: ${rowCount.toLocaleString()} è¡Œ Ã— ${colCount} åˆ—`);
        log(`æ–‡ä»¶å: ${fileName}`);
        log(
          `æ ·å¼: ${includeStyles ? "âœ“" : "âœ—"} | å¯Œæ–‡æœ¬: ${
            includeRichText ? "âœ“" : "âœ—"
          }`
        );

        // åˆ›å»ºå¯¼å‡ºå™¨å®ä¾‹
        const exporter = new FulExcelExport({ fileName });
        log("å¯¼å‡ºå™¨å·²åˆ›å»º");

        // æ·»åŠ å·¥ä½œè¡¨
        const worksheet = exporter.addWorkSheet({
          name: "æ•°æ®",
          columnCount: colCount,
        });
        log(`å·¥ä½œè¡¨å·²åˆ›å»º: ${worksheet.name}`);

        // ç”Ÿæˆè¡¨å¤´è¡Œ
        const headerRowData = [];
        for (let i = 0; i < colCount; i++) {
          const cell = { value: colNames[i] || `åˆ—${i + 1}` };
          if (includeStyles) {
            cell.bold = true;
            cell.fill = "#4472C4";
            cell.color = "#FFFFFF";
            cell.align = "center";
          }
          headerRowData.push(cell);
        }

        // ç”Ÿæˆæ™®é€šæ•°æ®è¡Œ
        function generateRow(i) {
          const row = [];
          const name = names[i % names.length];
          const age = 20 + (i % 40);
          const dept = departments[i % departments.length];
          const pos = positions[i % positions.length];
          const email = `${name}${i}@company.com`;

          for (let col = 0; col < colCount; col++) {
            let cell = {};
            switch (col) {
              case 0:
                cell = { value: `${name}${i}` };
                if (includeStyles && i % 5 === 0) {
                  cell.fill = "#FFFF00";
                  cell.bold = true;
                }
                break;
              case 1:
                cell = { value: age };
                if (includeStyles && age > 40) {
                  cell.color = "#FF0000";
                }
                break;
              case 2:
                cell = { value: dept };
                break;
              case 3:
                cell = { value: pos };
                if (includeStyles) {
                  cell.italic = true;
                }
                break;
              case 4:
                cell = { value: `EMP${String(i).padStart(6, "0")}` };
                if (includeStyles) {
                  cell.fontFamily = "Courier New";
                }
                break;
              case 5:
                cell = {
                  value: `2020-${String((i % 12) + 1).padStart(
                    2,
                    "0"
                  )}-${String((i % 28) + 1).padStart(2, "0")}`,
                };
                break;
              case 6:
                cell = { value: 5000 + (i % 20) * 1000 };
                if (includeStyles) {
                  cell.border = true;
                  cell.align = "right";
                }
                break;
              case 7:
                if (includeRichText && i % 10 === 0) {
                  cell = { value: `<b>${email}</b>` };
                } else {
                  cell = { value: email };
                }
                break;
              case 8:
                cell = { value: `138${String(i).padStart(8, "0").slice(-8)}` };
                break;
              case 9:
                if (includeRichText && i % 7 === 0) {
                  cell = { value: `<i>åŒ—äº¬å¸‚æœé˜³åŒº${i}å·</i>` };
                } else {
                  cell = { value: `åŒ—äº¬å¸‚æœé˜³åŒº${i}å·` };
                }
                break;
              default:
                cell = { value: `æ•°æ®${col}-${i}` };
            }
            row.push(cell);
          }
          return row;
        }

        // è¿›åº¦å›è°ƒ
        exporter.onProgress((percent, stage, message, memory) => {
          progressFill.style.width = percent + "%";
          progressPercent.textContent = percent + "%";

          const stageNames = {
            init: "åˆå§‹åŒ–",
            building: "ç”Ÿæˆä¸­",
            compressing: "å‹ç¼©ä¸­",
            done: "å®Œæˆ",
            error: "é”™è¯¯",
          };
          progressStage.textContent = stageNames[stage] || stage;
          progressMessage.textContent = message;
          log(`${stageNames[stage] || stage}: ${message}`);

          if (memory) {
            const usedHeap = parseFloat(memory.usedHeap) || 0;
            const totalHeap = parseFloat(memory.totalHeap) || 0;
            const limit = parseFloat(memory.limit) || totalHeap;
            const memPercent =
              limit > 0 ? Math.min(100, (usedHeap / limit) * 100) : 0;

            memUsedHeap.textContent = usedHeap;
            memTotalHeap.textContent = totalHeap;
            memLimit.textContent = limit;
            memoryUsed.style.width = memPercent + "%";
          }
        });

        try {
          const PAGE_SIZE = 1000;
          const totalPages = Math.ceil((rowCount + 1) / PAGE_SIZE); // +1 for header
          log(`åˆ†é¡µæ•°: ${totalPages} é¡µ (æ¯é¡µ ${PAGE_SIZE} è¡Œ)`);

          // åˆ†é¡µç”Ÿæˆå¹¶å†™å…¥æ•°æ®
          for (let page = 0; page < totalPages; page++) {
            const pageData = [];
            const startIdx = page * PAGE_SIZE;
            const endIdx = Math.min(startIdx + PAGE_SIZE, rowCount + 1);

            for (let idx = startIdx; idx < endIdx; idx++) {
              if (idx === 0) {
                pageData.push(headerRowData);
              } else {
                pageData.push(generateRow(idx - 1));
              }
            }

            await worksheet.addRows(pageData);

            // æ¯10é¡µè¾“å‡ºä¸€æ¬¡æ—¥å¿—
            if ((page + 1) % 10 === 0 || page === totalPages - 1) {
              log(`å·²å†™å…¥ ${page + 1} / ${totalPages} é¡µ`);
            }
          }
          log("æ•°æ®å†™å…¥å®Œæˆ", "success");

          log("å¼€å§‹å‹ç¼©å¯¼å‡º...");
          const result = await exporter.export();

          console.log("å¯¼å‡ºæˆåŠŸ:", result);
          log(
            `âœ… å¯¼å‡ºæˆåŠŸï¼è¡Œæ•°: ${result.rows.toLocaleString()}, å¤§å°: ${
              result.sizeMB
            }MB`,
            "success"
          );
          alert(
            `å¯¼å‡ºæˆåŠŸï¼\nè¡Œæ•°: ${result.rows.toLocaleString()}\nå·¥ä½œè¡¨: ${
              result.sheets
            }\næ–‡ä»¶å¤§å°: ${result.sizeMB} MB`
          );
        } catch (error) {
          console.error("å¯¼å‡ºå¤±è´¥:", error);
          log(`âŒ å¯¼å‡ºå¤±è´¥: ${error.message}`, "error");
          alert("å¯¼å‡ºå¤±è´¥: " + error.message);
        } finally {
          clearInterval(timer);
          btn.disabled = false;
          btn.textContent = "ğŸš€ å¼€å§‹å¯¼å‡º";
        }
      };
    </script>
  </body>
</html>
